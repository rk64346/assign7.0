{
 "cells": [
  {
   "cell_type": "markdown",
   "id": "a85db738-15a4-4d74-af10-b15df8a35b82",
   "metadata": {},
   "source": [
    "Q10. Given a Pandas DataFrame df with a column 'Sales' and a column 'Date', write a Python function to\n",
    "create a new column 'MovingAverage' that contains the moving average of the sales for the past 7 days\n",
    "for each row in the DataFrame. The moving average should be calculated using a window of size 7 and\n",
    "should include the current day."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "b372df64-7836-45b9-b4e9-04beadc89c8b",
   "metadata": {},
   "outputs": [],
   "source": [
    "import pandas as pd"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "df7c7c0f-0c21-4f92-a1c4-9972803dde80",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Requirement already satisfied: pandas in /opt/conda/lib/python3.10/site-packages (1.5.2)\n",
      "Requirement already satisfied: python-dateutil>=2.8.1 in /opt/conda/lib/python3.10/site-packages (from pandas) (2.8.2)\n",
      "Requirement already satisfied: pytz>=2020.1 in /opt/conda/lib/python3.10/site-packages (from pandas) (2022.6)\n",
      "Requirement already satisfied: numpy>=1.21.0 in /opt/conda/lib/python3.10/site-packages (from pandas) (1.23.5)\n",
      "Requirement already satisfied: six>=1.5 in /opt/conda/lib/python3.10/site-packages (from python-dateutil>=2.8.1->pandas) (1.16.0)\n",
      "Note: you may need to restart the kernel to use updated packages.\n"
     ]
    }
   ],
   "source": [
    "pip install pandas\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "9b69f7d1-c710-405f-881e-0871c430ab5b",
   "metadata": {},
   "outputs": [],
   "source": [
    "df =  pd.read_csv(\"shampoo_sales.csv\")\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "a9a9e23e-7734-439d-980c-d6cbae12cc1c",
   "metadata": {},
   "outputs": [],
   "source": [
    "df[df['MovingAverage']]."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 35,
   "id": "22e31bba-d124-4593-9445-784339f0969b",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Month</th>\n",
       "      <th>Sales</th>\n",
       "      <th>MovingAverage</th>\n",
       "      <th>0</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>01-Jan</td>\n",
       "      <td>266.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>01-Feb</td>\n",
       "      <td>145.9</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>01-Mar</td>\n",
       "      <td>183.1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>01-Apr</td>\n",
       "      <td>119.3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>01-May</td>\n",
       "      <td>180.3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>01-Jun</td>\n",
       "      <td>168.5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>6</th>\n",
       "      <td>01-Jul</td>\n",
       "      <td>231.8</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>7</th>\n",
       "      <td>01-Aug</td>\n",
       "      <td>224.5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8</th>\n",
       "      <td>01-Sep</td>\n",
       "      <td>192.8</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>01-Oct</td>\n",
       "      <td>122.9</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>10</th>\n",
       "      <td>01-Nov</td>\n",
       "      <td>336.5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>11</th>\n",
       "      <td>01-Dec</td>\n",
       "      <td>185.9</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>12</th>\n",
       "      <td>02-Jan</td>\n",
       "      <td>194.3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>13</th>\n",
       "      <td>02-Feb</td>\n",
       "      <td>149.5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>14</th>\n",
       "      <td>02-Mar</td>\n",
       "      <td>210.1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>02-Apr</td>\n",
       "      <td>273.3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>02-May</td>\n",
       "      <td>191.4</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>02-Jun</td>\n",
       "      <td>287.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>18</th>\n",
       "      <td>02-Jul</td>\n",
       "      <td>226.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>19</th>\n",
       "      <td>02-Aug</td>\n",
       "      <td>303.6</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>20</th>\n",
       "      <td>02-Sep</td>\n",
       "      <td>289.9</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>21</th>\n",
       "      <td>02-Oct</td>\n",
       "      <td>421.6</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>02-Nov</td>\n",
       "      <td>264.5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>02-Dec</td>\n",
       "      <td>342.3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>24</th>\n",
       "      <td>03-Jan</td>\n",
       "      <td>339.7</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25</th>\n",
       "      <td>03-Feb</td>\n",
       "      <td>440.4</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>03-Mar</td>\n",
       "      <td>315.9</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>27</th>\n",
       "      <td>03-Apr</td>\n",
       "      <td>439.3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>28</th>\n",
       "      <td>03-May</td>\n",
       "      <td>401.3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>29</th>\n",
       "      <td>03-Jun</td>\n",
       "      <td>437.4</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>30</th>\n",
       "      <td>03-Jul</td>\n",
       "      <td>575.5</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>31</th>\n",
       "      <td>03-Aug</td>\n",
       "      <td>407.6</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>32</th>\n",
       "      <td>03-Sep</td>\n",
       "      <td>682.0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>33</th>\n",
       "      <td>03-Oct</td>\n",
       "      <td>475.3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>34</th>\n",
       "      <td>03-Nov</td>\n",
       "      <td>581.3</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>35</th>\n",
       "      <td>03-Dec</td>\n",
       "      <td>646.9</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "     Month  Sales  MovingAverage  0\n",
       "0   01-Jan  266.0              0  0\n",
       "1   01-Feb  145.9              0  0\n",
       "2   01-Mar  183.1              0  0\n",
       "3   01-Apr  119.3              0  0\n",
       "4   01-May  180.3              0  0\n",
       "5   01-Jun  168.5              0  0\n",
       "6   01-Jul  231.8              0  0\n",
       "7   01-Aug  224.5              0  0\n",
       "8   01-Sep  192.8              0  0\n",
       "9   01-Oct  122.9              0  0\n",
       "10  01-Nov  336.5              0  0\n",
       "11  01-Dec  185.9              0  0\n",
       "12  02-Jan  194.3              0  0\n",
       "13  02-Feb  149.5              0  0\n",
       "14  02-Mar  210.1              0  0\n",
       "15  02-Apr  273.3              0  0\n",
       "16  02-May  191.4              0  0\n",
       "17  02-Jun  287.0              0  0\n",
       "18  02-Jul  226.0              0  0\n",
       "19  02-Aug  303.6              0  0\n",
       "20  02-Sep  289.9              0  0\n",
       "21  02-Oct  421.6              0  0\n",
       "22  02-Nov  264.5              0  0\n",
       "23  02-Dec  342.3              0  0\n",
       "24  03-Jan  339.7              0  0\n",
       "25  03-Feb  440.4              0  0\n",
       "26  03-Mar  315.9              0  0\n",
       "27  03-Apr  439.3              0  0\n",
       "28  03-May  401.3              0  0\n",
       "29  03-Jun  437.4              0  0\n",
       "30  03-Jul  575.5              0  0\n",
       "31  03-Aug  407.6              0  0\n",
       "32  03-Sep  682.0              0  0\n",
       "33  03-Oct  475.3              0  0\n",
       "34  03-Nov  581.3              0  0\n",
       "35  03-Dec  646.9              0  0"
      ]
     },
     "execution_count": 35,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "def moving_avg(df):\n",
    "    "
   ]
  },
  {
   "cell_type": "raw",
   "id": "657fb856-3112-41d9-8300-c1115ef8048a",
   "metadata": {},
   "source": [
    "Q11. You have a Pandas DataFrame df with a column 'Date'. Write a Python function that creates a new\n",
    "column 'Weekday' in the DataFrame. The 'Weekday' column should contain the weekday name (e.g.\n",
    "Monday, Tuesday) corresponding to each date in the 'Date' column.\n",
    "For example, if df contains the following values:\n",
    "Date\n",
    "0 2023-01-01\n",
    "1 2023-01-02\n",
    "2 2023-01-03\n",
    "3 2023-01-04\n",
    "4 2023-01-05\n",
    "Your function should create the following DataFrame:\n",
    "\n",
    "Date Weekday\n",
    "0 2023-01-01 Sunday\n",
    "1 2023-01-02 Monday\n",
    "2 2023-01-03 Tuesday\n",
    "3 2023-01-04 Wednesday\n",
    "4 2023-01-05 Thursday\n",
    "The function should return the modified DataFrame."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "c88ca043-7b01-4a5f-94fc-e27fab45f2ea",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "          date    weekday\n",
      "0   2023-01-01     Sunday\n",
      "1   2023-01-02     Monday\n",
      "2   2023-01-03    Tuesday\n",
      "3   2023-01-04  Wednesday\n",
      "4   2023-01-05   Thursday\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd \n",
    "def new_weekday_column(df):\n",
    "        df['weekday'] = pd.to_datetime(df['date']).dt.strftime('%A')\n",
    "        return df\n",
    "\n",
    "data = {'date':[' 2023-01-01',\n",
    "' 2023-01-02',\n",
    "' 2023-01-03',\n",
    "' 2023-01-04',\n",
    "'2023-01-05']\n",
    "       }\n",
    "df = pd.DataFrame(data)\n",
    "weekday = new_weekday_column(df)\n",
    "print(weekday)\n",
    "    \n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "raw",
   "id": "7edca6be-59f7-4831-98ed-5db1222d9c05",
   "metadata": {},
   "source": [
    "Q12. Given a Pandas DataFrame df with a column 'Date' that contains timestamps, write a Python\n",
    "function to select all rows where the date is between '2023-01-01' and '2023-01-31'."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "456c271d-f423-42d8-ba7a-5b719924a6ee",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "        date\n",
      "0 2023-01-01\n",
      "1 2023-01-15\n",
      "2 2023-01-20\n",
      "4 2023-01-10\n"
     ]
    }
   ],
   "source": [
    "import pandas as pd\n",
    "\n",
    "def filter_date_range(df):\n",
    "    start_date = '2023-01-01'\n",
    "    end_date = '2023-01-31'\n",
    "    filtered_df =df[df['date'].between(start_date,end_date)]\n",
    "    return filtered_df\n",
    "    \n",
    "data = {'date':['2023-01-01', '2023-01-15', '2023-01-20', '2023-02-05', '2023-01-10']\n",
    "}\n",
    "df = pd.DataFrame(data) \n",
    "df['date']= pd.to_datetime(df['date'])\n",
    "filtered_df = filter_date_range(df)\n",
    "print(filtered_df)\n"
   ]
  },
  {
   "cell_type": "markdown",
   "id": "f5880e97-f771-421f-83bf-f7913c4e8022",
   "metadata": {},
   "source": [
    "Q13. To use the basic functions of pandas, what is the first and foremost necessary library that needs to\n",
    "be imported?"
   ]
  },
  {
   "cell_type": "raw",
   "id": "3aa7d88c-e240-4b8c-83b5-95b1f76d83b2",
   "metadata": {},
   "source": [
    "import pandas as pd and install pandas by using pip install pandas and refresh the kerner to add the basic lib in the cunsole"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "d2b79a43-45a5-4f53-9b6f-a3ceac03dbbc",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.8"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
